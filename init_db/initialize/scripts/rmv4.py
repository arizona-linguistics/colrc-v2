import re
r = open('fixed_entries3.txt', 'r')
f = open('fixed_entries4.txt', 'w+')
for line in r.readlines():
    line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\(v[it.].*\.?)\s(\(.*):::(.*)', r'\1\3:::\2\4', line)
    line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*\.)\s*(\(\(v\..*):::(.*)', r'\1\3:::\2', line)
    line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*[.!])\s*(\(v\..*):::(.*)', r'\1\3:::\2', line)
    line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*\.)\s*(\(vt.*):::(.*)', r'\1:::\2\3', line)
    line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*\.)\s*(\(nod.*):::(.*)', r'\1:::\2 \3', line)
    line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\[[xa].*\])(.*):::(.*)', r'\1\3:::\4\2', line)
    line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\[see.*\])(.*):::(.*)', r'\1\3:::\4\2', line)
    line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\(stem\).*):::(.*)', r'\1:::\2 \3', line)
    # part of speech from all [] cases
    if re.match(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*):::(.*)(\[.*\])', line):
        line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*):::(.*)(\[.*\])', r'\1:::\2:::\3', line)
    else:
        line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)', r'\1:::', line)
    line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::vt\.)\)\s*(\[xref.*\])\s*:::(.*)', r'\1:::\2\3', line)

    # separate xref with other notes
    if re.match(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\[.*\])?(\[.*\])(.*)', line):
        if re.match(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\[[wrmlf].*\])(.*)', line):
            line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\[[wrmlf].*\])(.*)', r'\1\3:::\2', line)
        elif re.match(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\[ph.*\])(.*)', line):
            line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\[ph.*\])(.*)', r'\1\3:::\2', line)
        elif re.match(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\[v\..*\])(.*)', line):
            line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\[v\..*\])(.*)', r'\1\3:::\2', line)
        else:
            line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)', r'\1:::', line)
    else:
        line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)', r'\1:::', line)

    # a = re.match(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)\[([xsa].*)\](.*):::(.*)', line)
    # # c = re.match(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)\[(also recorded as.*)\](.*):::(.*)', line)
    # if a:
    #     line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\[[xsa].*\])(.*):::(.*)', r'\1\3:::\4:::\2', line)
    #
    # else:
    #     line = re.sub(r'(^.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)', r'\1:::', line)
    # # line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\[xref.*\])(.*):::(.*)', r'\1\3:::\2\4', line)
    # line = re.sub(r'(^.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\(\(stem.*\).*):::(.*):::(.*)', r'\1:::\2 \3:::\4', line)
    #
    # # separate pos from xref, or see alsos
    # b = re.match(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*):::(.*)(\[.*\]).*', line)
    # if b:
    #     line = re.sub(r'(.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*:::.*)(\[xref.*\])(.*):::', r'\1\3:::\2', line)


    f.write(line)
